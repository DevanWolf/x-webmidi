<html>
  <head></head>
  <body>
    <script src="bower_components/webcomponentsjs/webcomponents.js"></script>
    <link rel="import" href="bower_components/x-webmidi/x-webmidirequestaccess.html">
    <x-webmidirequestaccess sysex="true" input="true" output="true"></x-webmidirequestaccess>

    <div>input 01: <x-webmidiinput id="input-port-01" autoreselect="true"></x-webmidiinput> <span id="midiinput-event-01"></span></div>
    <div>input 02: <x-webmidiinput id="input-port-02" autoreselect="true"></x-webmidiinput> <span id="midiinput-event-02"></span></div>
    <div>output 01: <x-webmidioutput id="output-port-01" autoreselect="true"></x-webmidioutput></div>
    <div>output 02: <x-webmidioutput id="output-port-02" autoreselect="true"></x-webmidioutput></div>
    <button id="sendsysex">Send SysEx</button>
    <br>

    <script>
    var exSendMessage=[];
    window.addEventListener("midiin-event:input-port-01", function(event){
        //var output1=document.getElementById("output-port-01");
        //if(output1.checkOutputIdx!="false") output1.sendRawMessage(event.detail.data);
        var sameByteCount=0;
        for(var i=0; i<exSendMessage.length; i++) {
            if(event.detail.data[i]==exSendMessage[i]) {
                sameByteCount++;                
            }
        }
        if(sameByteCount!=event.detail.data.length) {
            var out=[];
            for(var i=0; i<event.detail.data.length; i++) {
                out.push(event.detail.data[i].toString(16));
            }
            console.log("[Recieved] ", event.detail.subType, event.detail.data.length, out);
        }
    });

    window.addEventListener("midiin-event:input-port-02", function(event){
        //var output1=document.getElementById("output-port-01");
        //if(output1.checkOutputIdx!="false") output1.sendRawMessage(event.detail.data);
        console.log("[Recieved] ",event.detail.subType, event.detail.data.length, event.detail.data);
    });


    document.getElementById("sendsysex").addEventListener("mousedown", function(event){
        var output1=document.getElementById("output-port-01");
        var data=[0xf0, 0x7e, 0x00, 0x06, 0x01, 0xf7];
        if(output1.checkOutputIdx!="false") {
            exSendMessage=data;
            output1.sendRawMessage(data);
        } else {
            console.log("error");
        }
    });
    </script>


  </body>
</html>